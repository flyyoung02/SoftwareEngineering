# miniOB泛读报告

# 1.    软件系统中的类及其功能

基于对“miniOB”开源软件的代码的阅读，以及对其代码组织结构和功能的分析，“miniOB”的代码构成和每个模块对应的主要功能如表1所示。



**表1** **miniOB的代码构成及实现功能**

| **程序包** | **子包** | **类**                | **实现功能**               |
| ---------- | -------- | --------------------- | -------------------------- |
| storage    | index    | BplusTreeIndex        | 管理和操作B+树索引         |
|            |          | BplusTreeIndexScanner | 扫描B+树索引               |
|            |          | AttrComparator | 比较两个属性 |
| | | KeyComparator | 根据属性值和RID值比较两个关键字，从而提供排序功能 |
| | | AttrPrinter | 根据属性类型将值转换成字符串 |
| | | KeyPrinter | 将键值对转换成字符串表示的功能，包括属性值和RID值 |
| | | IndexFileHeader | 存储与数据文件的结构相关的属性、键、类型和根页号信息的成员，还包含了将这些信息转换为字符串格式以及设置不同成员值的方法 |
| | | IndexNodeHandler | 初始化、验证和检索数据文件中索引节点信息 |
| | | LeafIndexNodeHandler : public IndexNodeHandler | 检索B+树叶节点的信息 |
| | | InternalIndexNodeHandler : public IndexNodeHandler | 操作B+树非叶节点的信息 |
| | | BplusTreeHandler | 提供创建索引、打开索引、插入索引项、删除索引项、获取记录等操作，支持对B+树结构进行打印输出和验证 |
| | | BplusTreeScanner | 用于在指定范围内扫描数据，并返回RID(记录标识符)。该类提供了open打开扫描器，next_entry获取下一条数据，以及close关闭扫描器的方法 |
| |          | Index                                              | 数据索引                                                     |
|            |          | IndexScanner                                       | 遍历元素数据 |
|            | common   | IndexMeta                                          | 元数据与JSON格式的互相转换                                   |
| | | ConditionFilter | 匹配一条数据的基类 |
| | | DefaultConditionFilter : public ConditionFilter | 匹配的具体实现 |
|            |          | CompositeConditionFilter : public ConditionFilter | 匹配的具体实现 |
| | | Db | 数据库类，包括初始化、创建表、查找表、列出所有表、同步、恢复和获取操作日志管理器等方法 |
| | | FieldMeta | 定义字段的基本属性，如名称、类型、偏移量、长度等，以及对这些属性进行初始化、输出描述和输出JSON格式 |
| | | Field | 维护Table和FieldMeta |
| | | Table | 表类，维护元数据保存的文件(完整路径)、表名、表数据存放的路径、字段个数、字段、clog管理器，用于维护redo log |
|            |          |                       |                            |
|            | default  | DefaultHandler        | 管理和处理数据库和表         |
|            |          | DefaultStorageStage   | 处理事件和回调的函数的实现   |
|            |          | Frame                 | 描述数据帧                  |
|            |          | BPFrameId             | 表示缓冲池中帧的唯一标识符    |
|            |          | BPFrameManager        | 管理缓冲池中的帧             |
|            |          | BufferPoolIterator    | 在缓冲池中迭代页面           |
|            |          | DiskBufferPool        | 管理分页文件的缓冲池         |
|            |          | BufferPoolManager     | 管理缓冲池                  |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                                                    |                                                              |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            | clog     | CLogRecord            | 处理日志记录 ，记录历史      |
|            |          | CLogBuffer            | 管理缓存的日志记录           |
|            |          | CLogFile              | 管理日志文件                |
|            |          | CLogManager           | 管理日志记录                |
|            |          |                       |                            |
|            |          |                       |                            |
|            | record   | RecordPageHandler     | 管理存储记录的页            |
|            |          | RecordFileHandler     | 管理存储记录的文件          |
|            |          | RecordFileScanner     | 对记录文件的扫描            |
|            |          | Record                | 表示记录                   |
|            |          | RecordPageIterato     | 管理记录页的迭代器          |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            | mem      | MemStorageStage       | 实现内存存储阶段的功能       |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            |          |                       |                            |
|            | trx      | Operation             | 对记录的操作                |
|            |          | OperationHasher       | 为操作提供哈希函数实现       |
|            |          | OperationEqualer      | 为操作提供相等比较函数实现   |
|            |          | Trx                   | 实现事务的相关操作          |
|            |          |                       |                            |
|            | persist  | PersistHandler        | 提供对文件的基本操作         |



——————————————————  以下是未修改的模板部分 ——————————————



## 2. 软件体系结构图

基于对“小米便签”代码组织结构、每个程序包在软件系统中的地位和作用、不同程序包之间的关系等方面的理解，可以用UML的包图绘制出“小米便签”开源软件的体系结构（见图1）。它整体上是一个XX性的体系结构，由XX层、XX层、XX个层次构成，每个层次包含若干个程序包。相邻层次的程序包之间存在交互。

(1) XX层

位于体系结构的 XX   ， 由XX 包中的类加以实现。

(2) XX层

该层是小米便签系统体系结构的核心，用于连接XX层和YY层，起到XX的作用，其提供的主要功能和服务包括：定义软件的业务XX，接收XX层的请求，与模型ZZ层、PP层进行交互，将处理结果返回给XX层。该层次主要通过“bb”、 “ww”包和“gg”包中的“ee”和“rr”子包以及其他相关部件加以实现。

(3) hh层

该层负责对小米便签的单个便签项进行建模，提供了便签项的基本操作功能和服务，并与数据层进行交互，以支持便签的创建、访问和修改。该层主要通过“model”程序包中的“NX ”类、“WX”类等加以实现。

(4) DD层

该层负责对小米便签的相关数据进行组织和存储，提供数XXX等功能和服务。该层主要通过“data”和“gtask.data”程序包加以实现。

 

**图1.** **小米便签体系结构图**

## 3.    各个子系统的类图

针对“小米便签”开源代码的各个程序包，还可以进一步深入分析包中的类以及它们之间的关系，绘制其实现类图。

 

**图2. data****程序包的实现类图**

 

**图3. gtask.data****程序包的实现类图**

 

 

**图4. gtask.remote****程序包的实现类图**

 

**图5. model****程序包的实现类图**

 

**图6. widget****程序包的实现类图**

 

 

**图7. ui****程序包的实现类图**

 

## 4.    软件的功能描述

根据“小米便签”开源软件在GitHub托管网站上提供的说明，通过运行和操作该软件系统，可以掌握“小米便签”提供了如下一组功能。

(1) 编辑/XX/XX/XX便签，支持用户管理便签，具体包括：

\-    创建和编辑便签，将创建好的便签置于文件夹中

\-     

(2) 新建/XX/XX，支持用户管理便签文件夹，具体包括：

\-    创建一个

\-     

(3) 便签同步，实现与TTT 中备忘录进行同步，具体包括：

\-    将小米便签的事项上传到YYY 服务器

\-    将YYY 服务器上的事项下载到本地

(4) 便签搜索，支持  。

(5) 添加/删除WW，具体包括：

\-    增加一个

\-    可删除一个

(6) 识别便签中的电话号码和网址，对便签编辑页面上  。。。。

(7) 便签分享，将用户所创建的便签。。。

此外，小米便签软件还提供了其他一组。。等等。

## 5.    软件功能与类间的对应关系

| **序号** | **功能名称**     | **实现模块**      | **实现方法** |
| -------- | ---------------- | ----------------- | ------------ |
| 1        | 新建便签         | NoteEditActivity  |              |
| 2        | 删除便签         | NoteEditActivity  |              |
| 3        | 移动便签         | DataUtils         |              |
| 4        | 新建文件夹       | NotesListActivity |              |
| 5        | 查看文件夹       | NotesListActivity |              |
| 6        |                  |                   |              |
| 7        |                  |                   |              |
| 8        |                  |                   |              |
| 9        |                  |                   |              |
| 10       |                  |                   |              |
| 11       |                  |                   |              |
| 12       |                  |                   |              |
| 13       |                  |                   |              |
| 14       |                  |                   |              |
| 15       |                  |                   |              |
| 16       |                  |                   |              |
| 17       | 识别电话号码     | Contact           |              |
| 18       | 分享             | NoteEditActivity  |              |
| 19       | 保存便签（自动） | WorkingNote       |              |

## 6.    收获

ü 在进行小米便签运行环境配置

ü  

## 7.    存在的问题

ü 由于对Java语言和Andriod开发的架构不够熟悉，。。。加深理解；

ü 由于大部分工作都是通过自学进行的，。。。，需要在实践的过程中逐步提升。
